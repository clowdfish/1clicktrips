<div>
  <ul class="result-list" ng-if="itineraries">
    <li class="result-list-item-container"
        ng-repeat="itinerary in itineraries"
        ng-init="itineraryIndex = $index">

      <span class="result-list-item-title">
        <h2>
          <span>Route {{ itineraryIndex + 1 }}</span>
          <span>{{ itinerary | titleExtractor }}</span>
          <a ng-click="showMap(itinerary)">{{ 'result.list.showonmap' | translate }}</a>
        </h2>

        <span class="result-list-item-title-details">
          <span class="result-list-item-price">{{ itinerary['price'].toFixed(2) }}
            <i class="fa {{ itinerary['currency'] | currencyFormatter }}"></i>
          </span>
          <span class="result-list-item-duration">{{ itinerary['duration'] | durationFormatter : 'full' }}</span>
        </span>
      </span>

      <span class="result-list-item-timeline">
        <span class="result-list-item-start"
               ng-class="{ focus: !timing['targetDate'] }"></span>

        <span class="result-list-item">
          <span class="result-list-item-line"></span>

          <span ng-repeat="container in itineraries[itineraryIndex]['segmentsContainer']"
                ng-init="containerIndex = $index">

            <!-- do not show minor segments and no major walking segments -->
            <span ng-repeat="segment in container['alternatives'][getAlternativeIndex(itineraryIndex, containerIndex)]"
                  ng-if="segment['departureTime'] && (!showDetails && segment['isMajor'] || showDetails)"
                  ng-init="segmentIndex = $index">

              <span ng-if="segment['alternatives'][getTimingIndex(itineraryIndex, containerIndex, segmentIndex)]['segments']">
                <!-- do not show walking segments -->
                <trip-segment
                   ng-repeat="detailSegment in segment['alternatives'][getTimingIndex(itineraryIndex, containerIndex, segmentIndex)]['segments']"
                   ng-if="detailSegment['type'] != 1"
                   segment="detailSegment"
                   ratio="{{ dimensions.ratio }}"
                   set-dimensions="setDimensions(data)"
                   define-left-margin="defineMarginLeft(time)">
                 </trip-segment>
              </span>
              <span ng-if="!segment['alternatives'][getTimingIndex(itineraryIndex, containerIndex, segmentIndex)]['segments']">
                <trip-segment
                  segment="segment"
                  ratio="{{ dimensions.ratio }}"
                  set-dimensions="setDimensions(data)"
                  define-left-margin="defineMarginLeft(time)">
                </trip-segment>
              </span>
            </span>
          </span>
        </span>
        <span class="result-list-item-end"
              ng-class="{ focus: timing['targetDate'] }"></span>
      </span>

      <h2 class="result-list-alternatives-title"
          ng-if="showAlternatives(itineraryIndex)">{{ 'result.list.timings.title' | translate }}</h2>
      <a class="result-list-alternatives-hide"
         ng-if="showAlternatives(itineraryIndex)"
         ng-click="toggleAlternatives(itineraryIndex)">{{ 'result.list.timings.hide' | translate }}</a>

      <span class="result-list-item-alternatives" ng-if="showAlternatives(itineraryIndex)">
        <span ng-repeat="container in itineraries[itineraryIndex]['segmentsContainer']"
              ng-init="containerIndex = $index">
          <span ng-repeat="segment in container['alternatives'][getAlternativeIndex(itineraryIndex, containerIndex)]"
                ng-init="segmentIndex = $index"
                ng-if="segment['departureTime'] && !showDetails && segment['isMajor'] && isPrioritySegment(itineraryIndex, containerIndex)">

            <span ng-repeat="alternative in segment['alternatives']"
                  ng-init="timingIndex = $index"
                  ng-if="$index !== getTimingIndex(itineraryIndex, containerIndex, segmentIndex)">

              <span class="result-list-item-timeline">
              <span class="result-list-item-start"
                    ng-class="{ focus: !timing['targetDate'] }"></span>

                <span class="result-list-item">
                  <span class="result-list-item-line"></span>

                  <span ng-if="segment['alternatives'][timingIndex]['segments']">
                  <!-- do not show walking segments -->
                    <trip-segment
                      ng-repeat="detailSegment in segment['alternatives'][timingIndex]['segments']"
                      ng-if="detailSegment['type'] != 1"
                      segment="detailSegment"
                      ratio="{{ dimensions.ratio }}"
                      set-dimensions="setDimensions(data)"
                      define-left-margin="defineMarginLeft(time)">
                    </trip-segment>
                  </span>
                  <span ng-if="!segment['alternatives'][timingIndex]['segments']">
                    <trip-segment
                      segment="segment"
                      ratio="{{ dimensions.ratio }}"
                      set-dimensions="setDimensions(data)"
                      define-left-margin="defineMarginLeft(time)">
                    </trip-segment>
                  </span>
              </span>

              <span class="result-list-item-end"
                    ng-class="{ focus: timing['targetDate'] }"></span>
              </span>
              <span class="result-list-alternative-selection">
                <span class="result-list-alternative-pricing">
                  <span>{{ segment['alternatives'][timingIndex]['price']['amount'].toFixed(2) }}</span>
                  <i class="fa {{ segment['alternatives'][timingIndex]['price']['currency'] | currencyFormatter }}"></i>
                </span>
                <a class="button" ng-click="selectAlternative(itineraryIndex, containerIndex, segmentIndex, alternativeIndex, timingIndex)">{{ 'result.list.select' | translate }}</a>
              </span>
            </span>
          </span>
        </span>
      </span>

      <span class="result-list-item-footer" ng-hide="showAlternatives(itineraryIndex)">
        <span class="result-list-item-footer-details">
          <span class="result-list-item-price">
            {{ itinerary['price'].toFixed(2) }}
            <i class="fa {{ itinerary['currency'] | currencyFormatter }}"></i>
          </span>
          <span class="result-list-item-duration">{{ itinerary['duration'] | durationFormatter : 'full' }}</span>
        </span>

         <span class="result-list-item-footer-action">
          <a ng-click="selectTrip(itineraryIndex)" class="button">{{ 'result.list.select' | translate }}</a>
          <a class="result-list-item-footer-action-link" ng-if="hasAlternatives(itineraryIndex)" ng-click="toggleAlternatives(itineraryIndex)">{{ 'result.list.timings.show' | translate }}</a>
        </span>

        <span class="result-list-item-annotation"
               ng-if="getAnnotation(itineraryIndex)">
          <span>*</span> {{ getAnnotation(itineraryIndex) }}
        </span>
      </span>
    </li>
  </ul>
</div>