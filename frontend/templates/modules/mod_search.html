<div ng-app='app.search'>
  <section class="search wrapper" ng-controller='searchCtrl'>
    <div class="search-steps">
      <!----------------------->
      <!-- SEARCH NAVIGATION -->
      <!----------------------->
      <ul class="search-step-list">
        <li class="search-step" ng-class="{active: step == 1, done: destinationAddress != null}" ng-click='step1()'>
          <div class="search-step-circle location">
            <span class="search-step-active-indicator"></span>
          </div>
          {{ T.search.navigation.destination }}
        </li>
        <li class="search-step" ng-class="{active: step == 2, done: (startDate != null && startTime != null && endDate != null && endTime != null)}" ng-click='step2()'>
          <div class="search-step-circle timing">
            <span class="search-step-active-indicator"></span>
          </div>
          {{ T.search.navigation.timing }}
        </li>
        <li class="search-step" ng-class="{active: step == 3, done: originAddress != null}" ng-click='step3()'>
          <div class="search-step-circle origin">
            <span class="search-step-active-indicator"></span>
          </div>
          {{ T.search.navigation.origin }}
        </li>
      </ul>
    </div>

    <div class="search-form-container">
      <!----------------------->
      <!-- DESTINATION FORM -------->
      <!----------------------->
      <form name='searchForm' class="search-form" ng-show='step == 1'>
        <h2>{{ T.search.form.destination.label }}</h2>

        <div class="search-form-location-field">
          <input
                  type="text"
                  placeholder="{{ T.search.form.destination.placeholder }}"
                  name='destination'
                  ng-model='destination'
                  typeahead="address.description for address in getSuggestion($viewValue)"
                  typeahead-on-select="selectDestinationSuggestion($item, $model, $label)" />

          <div ng-model='destinationType' class="btn-group search-form-location-field-dropdown" dropdown is-open="status.isopen">
            <button type="button" class="btn btn-primary dropdown-toggle" dropdown-toggle ng-disabled="disabled">
              <i class="fa {[ destinationType | destinationTypeToIcon ]}"></i><span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <li ng-repeat="item in destinationTypeArray" ng-click="setDestinationType(item)">{[item]}</li>
              <!--<li class="divider"></li>-->
            </ul>
          </div>
        </div>

        <map-marker address="destinationAddress" class="search-destination-map"></map-marker>
        <div class="search-form-process-indicator">
          <span class="search-form-process-step active"></span>
          <span class="search-form-process-step"></span>
          <span class="search-form-process-step"></span>
        </div>
        <a ng-click="step2()" class="button--dark" ng-class="{ 'is-disabled': destinationAddress == null }">{{ T.search.form.control.next }}</a>
      </form>

      <!----------------------->
      <!-- SCHEDULE FORM ------>
      <!----------------------->
      <form name='scheduleForm' class='search-form' ng-show='step == 2'>
        <h2>{{ T.search.form.time }}</h2>
        <div class='popup-date-picker-container'>
          <input type="text" class="form-control"
            show-weeks="false"
            ng-model="startDate"
            datepicker-options="dateOptions"
            datepicker-popup="{{format}}"
            ng-required="true"
            placeholder="Start Date"
            is-open="isOpenStartDatePicker"
            show-button-bar="false"
            close-text="Close" />

          <a class='btn-open-datepicker-popup' ng-click="openStartDatePicker($event)"><i class="fa fa-calendar"></i></a>

        </div>
        <div class='popup-date-picker-container'>
          <input type="text" class="form-control"
            show-weeks="false"
            ng-model="endDate"
            datepicker-options="dateOptions"
            datepicker-popup="{{format}}"
            ng-required="true"
            placeholder="End Date"
            is-open="isOpenEndDatePicker"
            show-button-bar="false"
            close-text="Close" />

          <a class='btn-open-datepicker-popup' ng-click="openEndDatePicker($event)"><i class="fa fa-calendar"></i></a>
        </div>

        <div class='popup-date-picker-container'>
          <input
            sy-timepicker-popup="HH:mm"
            class="form-control"
            ng-model="startTime"
            show-meridian="true"
            is-open="isOpenStartTimePicker"
            show-seconds="false"
            placeholder="Start time"
            ng-click="openStartTimePicker($event)" />
        </div>

        <div class='popup-date-picker-container'>
          <input
            sy-timepicker-popup="HH:mm"
            class="form-control"
            ng-model="endTime"
            show-meridian="true"
            is-open="isOpenEndTimePicker"
            show-seconds="false"
            placeholder="End time"
            ng-click="openEndtTimePicker($event)" />
        </div>

        <div class="search-form-process-indicator">
          <span class="search-form-process-step"></span>
          <span class="search-form-process-step active"></span>
          <span class="search-form-process-step"></span>
        </div>
        <a ng-click="step3()" class="button--dark">{{ T.search.form.control.next }}</a>
      </form>

      <!----------------------->
      <!-- ORIGIN FORM -------->
      <!----------------------->
      <form name='searchForm' class="search-form" ng-show='step == 3'>
        <h2>{{ T.search.form.origin }}</h2>

        <div class="search-form-location-field">
          <input
                  type="text"
                  placeholder="{{ T.search.form.origin }}"
                  name='origin'
                  ng-model='origin'
                  typeahead="address.description for address in getAddressSuggestion($viewValue)"
                  typeahead-on-select="selectOriginSuggestion($item, $model, $label)" />
        </div>

        <map-marker address="originAddress" class="search-destination-map"></map-marker>
        <div class="search-form-process-indicator">
          <span class="search-form-process-step"></span>
          <span class="search-form-process-step"></span>
          <span class="search-form-process-step active"></span>
        </div>
        <a ng-click="startSearch()" class="button--dark" ng-class="{ 'is-disabled': originAddress != null }">{{ T.search.form.control.submit }}</a>
      </form>
    </div>
  </section>
</div>